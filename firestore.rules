
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // A user can only access their own user document.
    match /users/{userId} {
      allow read, write: if request.auth.uid == userId;

      // Rules for the 'familyMembers' subcollection
      match /familyMembers/{memberId} {
        // A user can read and list their own family members.
        allow get, list: if request.auth.uid == userId;
        // A user can create, update, and delete their own family members.
        allow create, update, delete: if request.auth.uid == userId;
      }

      // Rules for the 'products' subcollection
      match /products/{productId} {
        // A user can read and list their own products.
        allow get, list: if request.auth.uid == userId;
        // A user can create, update, and delete their own products.
        allow create, update, delete: if request.auth.uid == userId;
      }

      // Rules for the 'expenses' subcollection
      match /expenses/{expenseId} {
         // A user can read and list their own expenses.
        allow get, list: if request.auth.uid == userId;
         // A user can create, update, and delete their own expenses.
        allow create, update, delete: if request.auth.uid == userId;
      }

      // Rules for the 'budget' subcollection
      match /budget/{budgetId} {
         // A user can read and list their own budget documents.
        allow get, list: if request.auth.uid == userId;
         // A user can create, update, and delete their own budget documents.
        allow create, update, delete: if request.auth.uid == userId;
      }
    }
  }
}
